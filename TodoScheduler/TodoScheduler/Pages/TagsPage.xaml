<?xml version="1.0" encoding="utf-8" ?>
<controls:BasePage xmlns="http://xamarin.com/schemas/2014/forms"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:controls="clr-namespace:TodoScheduler.Controls;assembly:TodoScheduler"
             xmlns:behaviors="clr-namespace:TodoScheduler.Behaviors;assembly:TodoScheduler"
             xmlns:iconize="clr-namespace:FormsPlugin.Iconize;assembly=FormsPlugin.Iconize"
             x:Class="TodoScheduler.Pages.TagsPage"
             Title="Tags" 
             BackgroundColor="{StaticResource GrayColor}">
  
    <controls:BasePage.ToolbarItems>
      <ToolbarItem Icon="refresh.png" Command="{Binding RefreshCommand}"/>
      <ToolbarItem Icon="bar_add_tag.png" Command="{Binding CreateTagCommand}"/>
    </controls:BasePage.ToolbarItems>
  <controls:StateContainer State="{Binding State}">
    <controls:StateCondition State="Normal">
      <ListView ItemsSource="{Binding TagItems}"
                        x:Name="list"
                        BackgroundColor="{StaticResource GrayColor}"
                        IsPullToRefreshEnabled="True"
                        IsRefreshing="{Binding IsRefresh}"
                        RefreshCommand="{Binding RefreshCommand}"
                        SeparatorVisibility="None"
                        RowHeight="170">
        <!--<ListView.Behaviors>
          <behaviors:EventToCommandBehavior EventName="ItemTapped"
                                            Command="{Binding ItemTappedCommand}"
                                            Converter="{StaticResource ItemTappedConverter}">
          </behaviors:EventToCommandBehavior>
        </ListView.Behaviors>-->
        <ListView.ItemTemplate>
          <DataTemplate>
            <ViewCell x:Name="cell">
              <Grid BackgroundColor="{StaticResource GrayColor}">
                <Frame HasShadow="True" OutlineColor="{StaticResource MainColor}" Padding="0" BackgroundColor="{StaticResource WhiteColor}" Margin="10,5">
                  <Grid>
                    <Grid.RowDefinitions>
                      <RowDefinition/> <!--Header-->
                      <RowDefinition/> <!--Counters-->
                      <RowDefinition/> <!--Buttons-->
                    </Grid.RowDefinitions>
                    <!--Header-->
                    <StackLayout Grid.Row="0" Padding="10" Orientation="Horizontal"
                                 BackgroundColor="{Binding HexColor}">
                      <iconize:IconImage HeightRequest="30"
                                         VerticalOptions="EndAndExpand"
                                         Icon="fa-bookmark" IconColor="{StaticResource WhiteColor}" />
                      <Label Text="{Binding Title}" Font="20" FontAttributes="Bold" 
                             TextColor="{StaticResource WhiteColor}" VerticalOptions="EndAndExpand"/>
                    </StackLayout>
                    <!--Counters-->
                    <Grid Grid.Row="1">
                      <Grid.ColumnDefinitions>
                        <ColumnDefinition/>
                        <ColumnDefinition/>
                        <ColumnDefinition/>
                      </Grid.ColumnDefinitions>
                      <StackLayout Grid.Column="0" Padding="10" Orientation="Horizontal" 
                                   HorizontalOptions="Center">
                        <Label Text="{Binding Total}" Font="20" FontAttributes="Bold"
                               TextColor="{StaticResource GrayColor}" VerticalOptions="Center"
                               HorizontalOptions="Center"/>
                      </StackLayout>
                      <!--completed-->
                      <StackLayout Grid.Column="1" Padding="10" Orientation="Horizontal"
                                   HorizontalOptions="Center">
                        <Label Text="{Binding Failed}" Font="20" FontAttributes="Bold"
                               TextColor="{StaticResource GrayColor}" 
                               VerticalOptions="Center" HorizontalOptions="Center"/>
                      </StackLayout>
                      <!--failed-->
                      <StackLayout Grid.Column="2" Padding="10" Orientation="Horizontal" HorizontalOptions="Center">
                        <Label Text="{Binding Completed}" Font="20" FontAttributes="Bold"
                               TextColor="{StaticResource GrayColor}" 
                               VerticalOptions="Center" HorizontalOptions="Center"/>
                      </StackLayout>
                    </Grid>
                    
                    <!--Counters-->
                    <Grid Grid.Row="2">
                      <Grid.ColumnDefinitions>
                        <ColumnDefinition/>
                        <ColumnDefinition/>
                        <ColumnDefinition/>
                      </Grid.ColumnDefinitions>
                      
                      <iconize:IconButton Grid.Column="0" 
                                          FontSize="20" 
                                          Text="fa-remove" 
                                          BackgroundColor="{StaticResource WhiteColor}"
                                          TextColor="Red" WidthRequest="25"
                                          Command="{Binding RemoveTagCommand}"
                                          BindingContext="{Binding Source={x:Reference list}, Path=BindingContext}"
                                          CommandParameter="{Binding Source={x:Reference cell}, Path=BindingContext}"/>
                      <!--Add todo btn-->
                      <iconize:IconButton Grid.Column="1"
                                          FontSize="20"
                                          Text="fa-plus"
                                          BackgroundColor="{StaticResource WhiteColor}"
                                          TextColor="{StaticResource GrayColor}" 
                                          WidthRequest="25"
                                          Command="{Binding AddTodoCommand}"
                                          BindingContext="{Binding Source={x:Reference list}, Path=BindingContext}"
                                          CommandParameter="{Binding Source={x:Reference cell}, Path=BindingContext}"/>
                      <!--Detaiд btn-->
                      <iconize:IconButton Grid.Column="2"
                                          FontSize="20"
                                          Text="fa-reorder"
                                          BackgroundColor="{StaticResource WhiteColor}"
                                          TextColor="{StaticResource GrayColor}" 
                                          WidthRequest="25"
                                          Command="{Binding DetailCommand}"
                                          BindingContext="{Binding Source={x:Reference list}, Path=BindingContext}"
                                          CommandParameter="{Binding Source={x:Reference cell}, Path=BindingContext}"/>
                    </Grid>
                  </Grid>
                </Frame>
                <!--<Frame HasShadow="True" Padding="0" Margin="0,5"
                       BackgroundColor="{StaticResource WhiteColor}">
                  <Grid BackgroundColor="{StaticResource WhiteColor}"
                        VerticalOptions="FillAndExpand"
                        HorizontalOptions="FillAndExpand">
                    <Grid.ColumnDefinitions>
                      <ColumnDefinition Width="Auto"/>
                      <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    
                    <iconize:IconImage Grid.Column="0" Margin="5" 
                                       HeightRequest="65" 
                                       VerticalOptions="StartAndExpand"
                                       Icon="fa-bookmark" IconColor="{Binding HexColor}" />

                    <Grid Grid.Column="1">
                      <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="40"/>
                      </Grid.RowDefinitions>

                      <Grid Grid.Row="0">
                        <Grid.ColumnDefinitions>
                          <ColumnDefinition/>
                          <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <StackLayout Grid.Column="0" Padding="0,5" Orientation="Vertical">
                          <Label Text="{Binding Title}" TextColor="{Binding HexColor}"
                                 FontSize="18" FontAttributes="Bold"/>
                          <Label Text="{Binding TodoItemsCount, StringFormat='Total items: {0}'}"
                                 Font="Small, Italic"/>
                        </StackLayout>

                        <StackLayout Grid.Column="1"
                                     Orientation="Horizontal" Padding="5"
                                     HorizontalOptions="EndAndExpand"
                                     VerticalOptions="StartAndExpand">
                          <controls:ImageButton Margin="5,0" 
                                                Source="remove_tag.png" 
                                                Command="{Binding RemoveTagCommand}"
                                                BindingContext="{Binding Source={x:Reference list}, Path=BindingContext}"
                                                CommandParameter="{Binding Source={x:Reference cell}, Path=BindingContext}"/>
                        </StackLayout>
                      </Grid>

                      <controls:Separator Grid.Row="1" Margin="0,0,10,0"/>

                      <StackLayout Grid.Row="2" 
                                   Orientation="Horizontal" Padding="10" 
                                   HorizontalOptions="EndAndExpand" 
                                   VerticalOptions="Center">
                        <controls:ImageButton Source="add_tag.png" Margin="5,0"/>
                        <controls:ImageButton Source="detail.png" Margin="5,0"/>
                      </StackLayout>
                    </Grid>
                  </Grid>
                </Frame>-->
              </Grid>
            </ViewCell>
          </DataTemplate>
        </ListView.ItemTemplate>
      </ListView>
    </controls:StateCondition>
    <controls:StateCondition State="Busy">
      
    </controls:StateCondition>
    <controls:StateCondition State="NoData">

    </controls:StateCondition>
  </controls:StateContainer>
</controls:BasePage>